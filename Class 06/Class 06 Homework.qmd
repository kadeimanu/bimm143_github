---
title: "Class 6 function Homework"
author: "Kaliyah A18125684"
format: pdf
toc: true
---
# Function Homework question 6: 
# Can you improve this analysis code?

library(bio3d)
s1 <- read.pdb("4AKE") # kinase with drug
s2 <- read.pdb("1AKE") # kinase no drug
s3 <- read.pdb("1E4Y") # kinase with drug
s1.chainA <- trim.pdb(s1, chain="A", elety="CA")
s2.chainA <- trim.pdb(s2, chain="A", elety="CA")
s3.chainA <- trim.pdb(s1, chain="A", elety="CA")
s1.b <- s1.chainA$atom$b
s2.b <- s2.chainA$atom$b
s3.b <- s3.chainA$atom$b
plotb3(s1.b, sse=s1.chainA, typ="l", ylab="Bfactor")
plotb3(s2.b, sse=s2.chainA, typ="l", ylab="Bfactor")
plotb3(s3.b, sse=s3.chainA, typ="l", ylab="Bfactor")

```{r}
library(bio3d)
plot_kinase <- function(seq) {
  read.pdb(seq)

}
s1 <- read.pdb("4AKE") # kinase with drug
s2 <- read.pdb("1AKE") # kinase no drug
s3 <- read.pdb("1E4Y") # kinase with drug
s1.chainA <- trim.pdb(s1, chain="A", elety="CA")
s2.chainA <- trim.pdb(s2, chain="A", elety="CA")
s3.chainA <- trim.pdb(s1, chain="A", elety="CA")
s1.b <- s1.chainA$atom$b
s2.b <- s2.chainA$atom$b
s3.b <- s3.chainA$atom$b
plotb3(s1.b, sse=s1.chainA, typ="l", ylab="Bfactor")
plotb3(s2.b, sse=s2.chainA, typ="l", ylab="Bfactor")
plotb3(s3.b, sse=s3.chainA, typ="l", ylab="Bfactor")
```

# Step 1 Basic function that reads pdb based on reference. 
```{r}
library(bio3d)
plot_kinase <- function(pdb.id, chain= "A", elety="CA") {
  #PDB
  pdb <- read.pdb(pdb.id)
}
plot_kinase("4AKE")
```

# Step 2 

Trim to selected chain and atom type
```{r}
library(bio3d)
plot_kinase <- function(pdb.id, chain= "A", elety="CA") {
  #PDB
  pdb <- read.pdb(pdb.id)
   pdb_trim <- trim.pdb(pdb, chain = chain, elety = elety)
}
plot_kinase("4AKE")
```

# Step 3

 Extract B-factors
```{r}
library(bio3d)
plot_kinase <- function(pdb.id, chain= "A", elety="CA") {
  #PDB
  pdb <- read.pdb(pdb.id)
   pdb_trim <- trim.pdb(pdb, chain = chain, elety = elety)
    b_vals <- pdb_trim$atom$b
}
plot_kinase("4AKE")
```
# Step 4

Plot function
  
```{r}
library(bio3d)
plot_kinase <- function(pdb.id, chain= "A", elety="CA") {
  #PDB
  pdb <- read.pdb(pdb.id)
   pdb_trim <- trim.pdb(pdb, chain = chain, elety = elety)
    b_vals <- pdb_trim$atom$b
    
      plotb3(b_vals,
         sse = pdb_trim,
         typ = "l",
         ylab = "B-factor",
         main = paste("B-factors for", pdb.id))
    
}
plot_kinase("4AKE")
plot_kinase("1AKE")
plot_kinase("1E4Y")
```


